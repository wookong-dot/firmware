/***************************************************************************
* File name    :    pxat_cmd.c
* Function     :    general command module
* Author       :    xinght
* Date         :    2019/01/09
* Version      :    v1.0
* Description  :
* ModifyRecord :
****************************************************************************/
/***************************************************************************
* Include Header Files
***************************************************************************/
#include "config.h"
#include "thm36x2.h"
#include "pxat_include.h"

/**************************************************************************
* Local Macro Definition
***************************************************************************/


/**************************************************************************
* Local Type Definition
***************************************************************************/


/**************************************************************************
* Local static Variable Declaration
***************************************************************************/
static uint8_t byRandom[8];

/**************************************************************************
* Global Variable Declaration
**************************************************************************/


/**************************************************************************
* Local Function Declaration
***************************************************************************/


/**************************************************************************
* Function
***************************************************************************/
void cmd_srsign(void)
{
    ALIGN(4) unsigned char g_message[32] = { 0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31,};
    ALIGN(4) unsigned char g_random[32] = { 0 };
    //ALIGN(4) unsigned char g_keypair[96] = { 74,83,195,251,188,89,151,14,229,248,90,248,19,135,93,255,193,58,144,74,46,83,174,126,101,250,13,234,110,98,201,1,159,7,231,190,85,81,56,122,152,186,151,124,115,45,8,13,203,15,41,160,72,227,101,105,18,198,83,62,50,238,122,237,156,102,163,57,200,52,79,146,47,195,32,108,181,218,232,20,165,148,192,23,125,211,35,92,37,77,156,64,154,101,184,8 }; 
    ALIGN(4) unsigned char g_keypair[96] = {  4,57,111,18,92,125,61,12,218,40,87,49,0,135,54,245,193,69,197,18,202,72,186,103,241,162,4,189,91,93,74,14,20,129,123,236,236,54,24,108,167,213,87,247,211,16,65,238,106,152,244,40,133,66,84,102,58,133,162,31,167,0,53,97,46,10,104,93,117,125,105,4,120,91,29,192,30,110,103,174,203,134,117,168,75,222,58,29,168,83,134,194,251,176,146,121};
			unsigned int rv = 0; 
    ALIGN(4) unsigned char g_signout[96] = { 0 };
	  
    rv = sr_sign(avalon_txrxbuf+TPL_DATA_POS,avalon_txrxbuf[7],g_random,g_keypair,g_signout);

    avalon_cmd_return(CRET_OK,g_signout,64);
    return;
}

void cmd_getchallenge(void)
{
    pkeGetRandomNum(byRandom,8);
    avalon_cmd_return(CRET_OK,byRandom,8);
    return;
}
